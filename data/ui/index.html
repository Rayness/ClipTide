<!-- Copyright (C) 2025 Rayness -->
<!-- This program is free software under GPLv3. See LICENSE for details. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <!-- <link rel="stylesheet" href="/data/fontawesome/css/all.min.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <title>ClipTide Video Downloader</title>
</head>
<body>
    <div class="left-panel">
        <div class="utils">
            <div class="tab-btn" data-tab="1" id="video-downloader">
                <i class="fa-solid fa-download"></i>
            </div>
            <div class="tab-btn" data-tab="2" id="converter">
                <i class="fa-solid fa-right-left"></i>
            </div>
        </div>
        <div class="settings">
            <div class="tab-btn" data-tab="10" id="settings">
                <i class="fa-solid fa-gears"></i>
            </div>
        </div>
    </div>
    <div class="conteiner">
        <div class="name">
            <h3 id="name">
                Video Downloader
            </h3>
        </div>
        <div class="main">
            <!-- Загрузчик видео -->
            <div class="content active" id="1" data-status="Video Downloader">
                <div class="download-settings fade-in">
                    <input class="url-input fade-in" type="text" id="videoUrl" placeholder="Введите URL видео">
                    <div class="settings-group">
                        <select id="format" class="select-control">
                            <option value="mp4">MP4</option>
                            <option value="mkv">MKV</option>
                            <option value="webm">WEBM</option>
                            <option value="avi">AVI</option>
                            <option disabled>-------------------------------------------</option>
                            <option value="mp3">MP3 (Только аудио)</option>
                            <option disabled>-------------------------------------------</option>
                            <option disabled value="m4a">M4A (Только аудио)</option>
                            <option disabled value="opus">OPUS (Только аудио)</option>
                            <option disabled value="aac">AAC (Только аудио)</option>
                            <option disabled value="flac">FLAC (Только аудио)</option>
                        </select>
                        <select id="resolution" class="select-control">
                            <option value="240">SD (240p)</option>
                            <option value="360">SD (360p)</option>
                            <option value="480">SD (480p)</option>
                            <option value="720">HD (720p)</option>
                            <option selected value="1080">FullHD (1080p)</option>
                            <option value="1440">2K (1440p)</option>
                            <option value="2160">4K (2160p)</option>
                            <option value="4320">8K (4320p)</option>
                        </select>
                        <div class="action-buttons">
                            <button class="primary-btn fade-in" id="addBtn"><i class="fa-solid fa-plus"></i></button>
                            <!-- <button class="primary-btn fade-in" id="startBtn">Начать загрузку</button> -->
                            <!-- <button class="primary-btn fade-in" disabled id="stopBtn">STOP</button> -->
                        </div>
                    </div>
                </div>
                <div id="queue-list" class="queue-container fade-in">
                    <ul id="queue" class="queue-items"></ul>
                </div>
            </div>

            <div class="content" id="11" data-status="Profile">
                <div class="coming-soon">
                    <i class="fa-solid fa-screwdriver-wrench"></i>
                    <h1 class="coming-soon_text">Coming Soon</h1>
                </div>
            </div>

            <div class="content" id="12" data-status="Notification">
                <div class="coming-soon">
                    <i class="fa-solid fa-screwdriver-wrench"></i>
                    <h1>Coming Soon</h1>
                </div>
            </div>

            <div class="content" id="2" data-status="Converter">
                <div class="converter-app">
                    <div class="input-file" id="input-file">
                        <div class="drop-zone" id="dropZone">
                            <i class="fa-solid fa-plus"></i>
                            <p id="converter_add_video">Кликните для выбора видео</p>
                        </div>
                    </div>
                    <div class="app" id="main-app">
                        <div class="main">
                            <div id="video-after" class="video">
                                <img id="conv_image" src="" alt="Видео">
                                <div class="text">
                                    <button id="close-video">Отмена</button>
                                    <p id="conv_name">Название</p>
                                    <div class="additional-text"><p id="video_info">Информация о видео:</p></div>
                                    <div class="additional">
                                        <div>
                                            <p id="conv_duration_text">Длительность: </p><p id="conv_duration">312312</p>
                                        </div>
                                        <!-- <p id="conv_format">Формат: </p> -->
                                         <div>
                                            <p id="conv_framerate_text">Частота кадров: </p><p id="conv_framerate">3213213</p>
                                         </div>
                                        <div>
                                            <p id="conv_video_codec_text">Видеокодек: <p id="conv_video_codec">321312</p></p>
                                        </div>
                                        <div>
                                            <p id="conv_bit_rate-video_text">Битрейт видео: </p><p id="conv_bit_rate-video">3213</p>
                                        </div>
                                        <div>
                                            <p id="conv_audio_codec_text">Аудиокодек: </p><p id="conv_audio_codec">31231</p>
                                        </div>
                                        <div>
                                            <p id="conv_bit_rate-audio_text">Битрейт аудио: </p><p id="conv_bit_rate-audio">32131</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="settings">
                            <div class="text">
                                <h3 id="convertion-settings">Настройки конвертации</h3>
                            </div>
                            <div class="format">
                                <p id="convertion_format">Формат: </p>
                                <select name="format" id="conv-format" class="select-control">
                                    <option value="mp4">mp4</option>
                                    <option value="avi">avi</option>
                                    <option value="mkv">mkv</option>
                                </select>
                                <button class="primary-btn" id="convert_btn">Конвертировать</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Контент с настройками -->
            <div class="content" id="10" data-status="Settings"> 
                <div id="app_settings" class="settings-block fade-in">
                    <div class="settings-row">
                        <div class="language-block">
                            <label for="language" id="language_title">Язык: </label>
                            <select id="language" class="select-control">
                                <option id="lang_en" value="en">Английский</option>
                                <option id="lang_de" value="de">Немецкий</option>
                                <option id="lang_pl" value="pl">Польский</option>
                                <option id="lang_ru" value="ru">Русский</option>
                                <option id="lang_ua" value="ua">Украинский</option>
                                <option id="lang_fr" value="fr">Французский</option>
                                <option id="lang_cn" value="cn">Китайский</option>
                                <option id="lang_ja" value="ja">Японский</option>
                            </select>
                        </div>
                        <div class="update-block">
                            <span id="update__text">Обновление: </span>
                            <button class="icon-btn" id="update">Проверить</button>
                        </div>
                    </div>
                    
                    <label for="folder_path" id="folder_title">Путь к папке загрузки: </label>
                    <div class="folder-controls">
                        <input class="input-folder" disabled type="text" id="folder_path" placeholder="Укажите путь к папке для загрузок">
                        
                        <div class="folder-icons">
                            <div class="tooltip-wrap">
                                <button class="icon-btn small" id="byDefoult"><i class="fa-solid fa-clock-rotate-left"></i></button>
                                <span class="tooltip" id="tooltip_defoult">Вернуть папку по умолчанию</span>
                            </div>
                            
                            <div class="tooltip-wrap">
                                <button class="icon-btn small" id="chooseButton"><i class="fa-solid fa-folder"></i></button>
                                <span class="tooltip" id="tooltip_choose">Изменить папку загрузки</span>
                            </div>
                            
                            <div class="tooltip-wrap">
                                <button class="icon-btn small" id="openFolder"><i class="fa-solid fa-folder-open"></i></button>
                                <span class="tooltip" id="tooltip_open">Открыть папку загрузки</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="down-panel">
            <div id="status" class="status-info fade-in">
                Статус: Ожидание...
            </div>
            <div id="loading-spinner" class="spinner-container">
                <div class="spinner"></div>
            </div>
            <div class="progress-info fade-in">
                <div id="progress">Прогресс: 0%</div>
                <div id="speed">Скорость: 0B/s</div>
                <div id="eta">Осталось: </div>
            </div>
            
            <div class="progress-bar fade-in">
                <div id="progress-fill" class="progress-fill"></div>
            </div>    
        </div>
    </div>
        
    <div class="right-panel">
        <div class="utils">
            <div class="tab-btn" data-tab="12">
                <i class="fa-solid fa-bell"></i>
            </div>
            <!-- <div class="tab-btn" data-tab="11">
                <i class="fa-solid fa-circle-user"></i>
            </div> -->
        </div>
        <div class="controls">
            <div class="buttons">
                <button id="startBtn"><i class="fa-solid fa-play"></i></button>
                <!-- <button><i class="fa-solid fa-pause"></i></button> -->
                <button id="stopBtn"><i class="fa-solid fa-stop"></i></button>
            </div>
        </div>
    </div>
    <script src="scripts.js" defer></script>
    <script src="ui-effects.js"></script>
    <script>
        window.onload = function () {
            console.log("Window loaded!");
            console.log("pywebview:", pywebview); // Проверяем, что pywebview определен
            console.log("Доступные методы js_api:", pywebview.api);

            if (pywebview && pywebview.api) {
                console.log("pywebview.api is available!");
            } else {
                console.error("pywebview.api is not defined!");
            }

            // Тестовый вызов метода после загрузки
            setTimeout(() => {
                if (pywebview && pywebview.api && pywebview.api.testMethod) {
                    console.log("Calling testMethod...");
                    pywebview.api.testMethod();
                } else {
                    console.error("pywebview.api.testMethod is not defined!");
                }
            }, 1000); // Задержка для гарантии загрузки
        };

        window.onerror = function (message, source, lineno, colno, error) {
            console.error("JavaScript error:", message, "in", source, "at line", lineno);
        };

        function callTestMethod() {
            if (pywebview && pywebview.api && pywebview.api.testMethod) {
                console.log("Calling testMethod...");
                pywebview.api.testMethod();
            } else {
                console.error("pywebview.api.testMethod is not defined!");
            }
        }

        callTestMethod()
    </script>
</body>
</html>